<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">

  <link rel="stylesheet" href="static/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="static/css/style.css">

  <title>[A10] - computed e Watch</title>
</head>
<body>

<div class="container"><div class="row"><div class="col-12">
    <h1>Computed</h1>
    <p>
        O computed possui um comportamento extremamente semelhante a utilizar um método, a única diferença está no
        fato que o computed gera cache do resultado. Enquanto os dados originais não sofrerem alterações, ele não
        executará as instruções toda vez, irá retornar o resultado que está no cache. <br />
        Caso o dado sofra alguma alteração, ele computa os dados novamente gera esse novo cache e retorna apenas
        o resultado cacheado até que sofra novamente alguma alteração.
    </p>

    <hr>

    <h1>Watch</h1>
    <p>
        Observa quando uma variável tem seu valor alterado e executa antes de ser aplicada a alteração. Ou seja, é
        possível rodar uma rotina se houver alguma alteração no conteúdo da variável, como por exemplo aplicar
        chamadas ajax para persistir o novo valor da variável, e etc.
    </p>

    <p class='text-tip'>
        <span class="titulo">Ajax:</span> <br />
        Para o caso citado acima, seria interessante criar uma função que realize a chamada ajax, e utilizar o watch
        para chamar a função. Exemplo disponível no código.
    </p>

    <hr>

    <h2>Exemplos</h2>

    <div class="row">
        <div class="col-12">
            <p>
                Os exemplos abaixo são para demonstrar as implementações diferentes utilizando computed e watch - a nível
                de código. Para visualizar na prática a diferença dos códigos utilizados para implementar no Watch e
                no Computed, olhe o código no arquivo.
            </p>
            <br />
        </div>

        <div class="col-4">
            <div class="titulo">Computed</div>
            <p>
                Digite no console do browser:
            </p>

            <code>
                $ app01.nome = 'a Filha da Tormenta'
            </code>

            <div id="app01">
                <div class="row">
                    <div class="col-12">
                        <p>
                            Data: <span class="in_console">{{nome}}</span>
                            <br />
                            Computed: <span class="in_console">{{toUpperCase}}</span>
                        </p>
                    </div>
                    <div class="col-6">
                    </div>
                </div>
            </div> <!-- #app01 ::end::-->

        </div>

        <div class="col-4">
            <div class="titulo">Watch</div>
            <p>
                Altere o primeiro nome no console do navegador para visualizar o nome completo. Após, se quiser, altere
                o último nome também.
            </p>
            <code>
                $ app02.firstName = 'Mãe de Dragões'
                <br />
                $ app02.lastName = 'Quebradora de Correntes'
            </code>

            <div id="app02">
                <div class="row">
                    <div class="col-12">
                        <p>
                            Nome completo: <span class="in_console">{{fullName}}</span>
                        </p>
                    </div>
                </div>
            </div> <!-- #app02 ::end::-->
        </div>

        <div class="col-4">
            <div class="titulo">Computed</div>

            <code>
                $ app03.firstName = 'a Não Queimada'
                <br />
                $ app03.lastName = 'Senhora dos Sete Reinos'
            </code>

            <div id="app03">
                <div class="row">
                    <div class="col-12">
                        <p>
                            Nome completo: <span class="in_console">{{fullName}}</span>
                        </p>
                    </div>
                </div>
            </div> <!-- #app03 ::end::-->
        </div>
    </div>

    <hr>

    <p class='text-tip'>
        <span class="titulo">Ordem das coisas</span> <br />
        Para entender melhor a ordem de execução das funções, vá no console do navegador, altere o valor de app01.nome
        para qualquer outro e <b>observe os prints no console</b>, com eles é possível verificar a ordem de execução.
    </p>

    <div id="app04"></div>




</div><!-- .col-12 ::end::--></div><!-- .row ::end:: --></div><!-- .container ::end:: -->

<script src="https://unpkg.com/vue"></script>

<script>
    let app01 = new Vue({
        el: "#app01",
        data:{
            nome: "Daenerys Targaryen",
        },
        computed:{
            toUpperCase(){
                console.log("entrou na função de computed.")
                return this.nome.toUpperCase()
            }
        },
        watch: {
            nome(novo, antigo){
                console.log("--- > início função watch")
                console.log("novo: ",novo)
                console.log("antigo: ",antigo)
                console.log("fim da função watch <---")
            }
        }
    })

    let app02 = new Vue({
        el: "#app02",
        data:{
            firstName: "Daenerys",
            lastName: "Targaryen",
            fullName: ''
        },

        watch: {
            firstName(newValue){
                this.fullName = newValue + " " + this.lastName
            },

            lastName(newValue){
                this.fullName = this.firstName + " " + newValue
            }
        }
    })

    let app03 = new Vue({
        el: "#app03",
        data:{
            firstName: "Daenerys",
            lastName: "Targaryen",
        },

        computed: {
            fullName(){
                return this.firstName + ' ' + this.lastName
            },
        }
    })

    // exemplo de watch + ajax:
    let app04 = new Vue({
        el: "#app04",
        data: {
            firstName: "",
            lastName: ""
        },
        watch:{
            firstName(newValue){
                this.updateUsuario()
            }
        },
        methods:{
            updateUsuario(){
                console.log("usuário:", this.firstName ,"foi atualizado com sucesso.")
                // fazer chamada ajax.
            }
        }
    })
</script>
</body>
</html>